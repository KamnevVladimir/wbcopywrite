import Vapor

/// ะคะพัะผะฐัะธัะพะฒะฐะฝะธะต ัะพะพะฑัะตะฝะธะน ะดะปั ะฑะพัะฐ
struct MessageFormatter {
    
    // MARK: - Welcome Messages
    
    static func welcome(user: User, plan: Constants.SubscriptionPlan, remainingText: Int, remainingPhoto: Int) -> String {
        """
        ๐ *ะัะธะฒะตั, \(user.displayName)!*
        
        ะฏ *ะะฐััะพัะบะฐะะะ* โ AI-ะบะพะฟะธัะฐะนัะตั ะดะปั WB/Ozon
        
        ๐ *ะขะฒะพะน ะฟะฐะบะตั:* \(plan.emoji) \(plan.name)
        ะััะฐะปะพัั: \(remainingText) ัะตะบััะพะฒ + \(remainingPhoto) ัะพัะพ
        
        ๐ก *ะัะธะผะตั ััะพ ั ัะพะทะดะฐั:*
        
        ะะพ: _"ะัะพััะพะฒะบะธ ะผัะถัะบะธะต ะฑะตะปัะต"_
        ะะพัะปะต: _"ะัะพััะพะฒะบะธ ะผัะถัะบะธะต Mizuno Wave ะฑะตะปัะต 46 ัะฐะทะผะตั ัะฟะพััะธะฒะฝัะต ะฟะพะดะพัะฒะฐ ะะธัะปะตะฝ"_
        
        ๐ *ะงัะพ ั ะดะตะปะฐั:*
        โ SEO-ะทะฐะณะพะปะพะฒะบะธ (100 ัะธะผะฒะพะปะพะฒ)
        โ ะัะพะดะฐััะธะต ะพะฟะธัะฐะฝะธั (500 ัะธะผะฒะพะปะพะฒ)
        โ 5 ะบะปััะตะฒัั ะฒัะณะพะด (bullets)
        โ 7 ัะตััะตะณะพะฒ ะดะปั ะฟะพะธัะบะฐ
        โ ะะฝะฐะปะธะท ัะพัะพ ัะพะฒะฐัะฐ ๐ท
        
        ๐ฐ *ะญะบะพะฝะพะผะธั:* ะะพะฟะธัะฐะนัะตั 500โฝ โ ะั 14โฝ!
        
        ะัะฑะตัะธ ะบะฐัะตะณะพัะธั ัะพะฒะฐัะฐ:
        """
    }
    
    // MARK: - Generation Results
    
    static func generationResult(
        title: String,
        description: String,
        bullets: [String],
        hashtags: [String],
        remainingText: Int,
        remainingPhoto: Int,
        nudge: String
    ) -> (part1: String, part2: String, part3: String) {
        let message1 = """
        โ *ะะพัะพะฒะพ!*
        
        ๐ *ะะะะะะะะะ:*
        \(title)
        
        ๐ *ะะะะกะะะะ:*
        \(description)
        """
        
        let bulletsText = bullets.map { "โข \($0)" }.joined(separator: "\n")
        let message2 = """
        ๐ฏ *ะะะฎะงะะะซะ ะะซะะะะซ:*
        
        \(bulletsText)
        """
        
        let hashtagsText = hashtags.joined(separator: " ")
        let message3 = """
        ๐ท *ะฅะะจะขะะะ:*
        \(hashtagsText)
        
        โโโโโโโโโโโโโโโโโโโ
        โก๏ธ *ะััะฐะปะพัั:* \(remainingText) ัะตะบััะพะฒ + \(remainingPhoto) ัะพัะพ\(nudge)
        """
        
        return (message1, message2, message3)
    }
    
    // MARK: - Smart Nudges
    
    static func smartNudge(remainingText: Int, remainingPhoto: Int, isFree: Bool) -> String {
        if remainingText == 1 && isFree {
            return """
            
            โ๏ธ *ะััะฐะปัั ะฟะพัะปะตะดะฝะธะน FREE ะบัะตะดะธั!*
            
            ๐ก ะ ะฟะฐะบะตัะต "ะะฐะปัะน" (299โฝ):
            โข 20 ะพะฟะธัะฐะฝะธะน = 14.95โฝ ะทะฐ ะบะฐะถะดะพะต
            โข ะะพะฟะธัะฐะนัะตั ะฑะตัะตั 500โฝ!
            โข ะญะบะพะฝะพะผะธั: 97%
            """
        } else if remainingText == 0 && isFree {
            return """
            
            ๐ *FREE ะบัะตะดะธัั ะทะฐะบะพะฝัะธะปะธัั*
            
            ๐ ะขะตะฑะต ะฟะพะฝัะฐะฒะธะปะพัั?
            ะัะพะดะพะปะถะธ ั ะปัะฑัะผ ะฟะฐะบะตัะพะผ:
            
            ๐ฆ ะะฐะปัะน: 20 ะพะฟะธัะฐะฝะธะน ะทะฐ 299โฝ
            ๐ฆ๐ฆ ะกัะตะดะฝะธะน: 50 ะพะฟะธัะฐะฝะธะน ะทะฐ 599โฝ (ะฟะพะฟัะปััะฝัะน!)
            ๐ฆ๐ฆ๐ฆ ะะพะปััะพะน: 100 ะทะฐ 999โฝ
            """
        } else if remainingText + remainingPhoto <= 5 && !isFree {
            return """
            
            โ๏ธ *ะกะบะพัะพ ะทะฐะบะพะฝัะฐััั ะบัะตะดะธัั!*
            ะฃัะฟะตะน ะดะพะบัะฟะธัั ะฟะฐะบะตั ๐
            """
        }
        
        return ""
    }
    
    // MARK: - Balance
    
    static func balance(
        plan: Constants.SubscriptionPlan,
        remainingText: Int,
        remainingPhoto: Int,
        hasTextCredits: Bool,
        hasPhotoCredits: Bool
    ) -> String {
        let textLine = hasTextCredits 
            ? "โข ะขะตะบััะพะฒัะต ะบัะตะดะธัั: \(remainingText)"
            : "โข ะขะตะบััะพะฒัั: \(remainingText) ะธะท \(plan.textGenerationsLimit)"
        
        let photoLine = hasPhotoCredits
            ? "โข ะคะพัะพ ะบัะตะดะธัั: \(remainingPhoto)"
            : "โข ะก ัะพัะพ: \(remainingPhoto) ะธะท \(plan.photoGenerationsLimit)"
        
        let totalLine = (hasTextCredits || hasPhotoCredits)
            ? "โข ะัะพะณะพ ะบัะตะดะธัะพะฒ: \(remainingText + remainingPhoto)"
            : "โข ะัะตะณะพ: \(remainingText + remainingPhoto) ะธะท \(plan.totalGenerationsLimit)"
        
        return """
        ๐ฐ *ะขะฒะพะน ะฑะฐะปะฐะฝั*
        
        ๐ฆ *ะขะตะบััะธะน ะฟะฐะบะตั:* \(plan.emoji) \(plan.name)
        
        ๐ *ะััะฐะปะพัั ะณะตะฝะตัะฐัะธะน:*
        \(textLine)
        \(photoLine)
        \(totalLine)
        
        ๐ก *ะฆะตะฝะฐ ะทะฐ ะณะตะฝะตัะฐัะธั:* \(plan.pricePerGeneration) โฝ
        """
    }
    
    // MARK: - Subscriptions
    
    static func subscriptionPlans(currentPlan: Constants.SubscriptionPlan) -> String {
        """
        ๐ *ะะะะะขะซ ะะะะขะะงะะะะะ*
        
        ะขะฒะพะน ัะตะบััะธะน: *\(currentPlan.emoji) \(currentPlan.name)*
        
        ๐ฆ *ะะะะซะ* - 299โฝ
        โข 20 ะพะฟะธัะฐะฝะธะน (20 ัะตะบััะพะฒ + 3 ะฑะพะฝัั ัะพัะพ)
        โข 14.95โฝ ะทะฐ ะพะฟะธัะฐะฝะธะต
        โข ะะปั 1-5 ัะพะฒะฐัะพะฒ/ะฝะตะดะตะปั
        
        ๐ฆ๐ฆ *ะกะะะะะะ* - 599โฝ
        โข 50 ะพะฟะธัะฐะฝะธะน (50 ัะตะบััะพะฒ + 5 ะฑะพะฝัั ัะพัะพ)
        โข 11.98โฝ ะทะฐ ะพะฟะธัะฐะฝะธะต
        โข ะะปั 10-15 ัะพะฒะฐัะพะฒ/ะฝะตะดะตะปั
        
        ๐ฆ๐ฆ๐ฆ *ะะะะฌะจะะ* - 999โฝ
        โข 100 ะพะฟะธัะฐะฝะธะน (100 ัะตะบััะพะฒ + 10 ะฑะพะฝัั ัะพัะพ)
        โข 9.99โฝ ะทะฐ ะพะฟะธัะฐะฝะธะต
        โข ะะปั 20-30 ัะพะฒะฐัะพะฒ/ะฝะตะดะตะปั
        
        ๐๐ *ะะะะกะะะะะฌะะซะ* - 1,399โฝ
        โข 200 ะพะฟะธัะฐะฝะธะน (200 ัะตะบััะพะฒ + 20 ะฑะพะฝัั ัะพัะพ)
        โข 6.99โฝ ะทะฐ ะพะฟะธัะฐะฝะธะต
        โข ะะปั ะฐะณะตะฝัััะฒ, 30+ ัะพะฒะฐัะพะฒ/ะฝะตะดะตะปั
        
        โโโโโโโโโโโโโโโโโโโ
        ๐ฐ *ะขะะะฏ ะญะะะะะะะฏ:*
        
        ะะพะฟะธัะฐะนัะตั: 500โฝ ะทะฐ ะพะฟะธัะฐะฝะธะต
        ะะฐะปัะน ะฟะฐะบะตั: 14.95โฝ ะทะฐ ะพะฟะธัะฐะฝะธะต
        
        *ะญะบะพะฝะพะผะธั: 97%!*
        
        ะัะธะผะตั (ะกัะตะดะฝะธะน ะฟะฐะบะตั):
        โ ะะพะฟะธัะฐะนัะตั: 50 ร 500โฝ = 25,000โฝ
        โ ะะฐััะพัะบะฐะะะ: 599โฝ
        ๐ *ะญะบะพะฝะพะผะธัั: 24,401โฝ/ะผะตั!*
        โโโโโโโโโโโโโโโโโโโ
        
        ๐ณ *ะัะฑะตัะธ ะฟะฐะบะตั ะดะปั ะฟะพะบัะฟะบะธ:*
        
        โ ะะพะฟัะพัั? \(Constants.Support.username)
        """
    }
    
    static func planDetails(plan: Constants.SubscriptionPlan) -> String {
        """
        ๐ *ะะฐะบะตั "\(plan.name)"*
        
        ๐ฐ *ะฆะตะฝะฐ:* \(plan.price)โฝ
        
        ๐ฆ *ะงัะพ ะฟะพะปััะธัั:*
        \(plan.description)
        
        ๐ก *ะฆะตะฝะฐ ะทะฐ ะพะฟะธัะฐะฝะธะต:* \(plan.pricePerGeneration) โฝ
        
        โโโโโโโโโโโโโโโโโโโ
        
        ๐ณ ะะฐะถะผะธ ะบะฝะพะฟะบั ะฝะธะถะต ะดะปั ะพะฟะปะฐัั
        
        ะะพัะปะต ััะฟะตัะฝะพะน ะพะฟะปะฐัั ะบัะตะดะธัั ะฑัะดัั ะฝะฐัะธัะปะตะฝั ะฐะฒัะพะผะฐัะธัะตัะบะธ! โ
        """
    }
    
    // MARK: - Errors & Info
    
    static func categorySelected(_ category: Constants.ProductCategory) -> String {
        """
        โ ะะฐัะตะณะพัะธั ะฒัะฑัะฐะฝะฐ: \(category.displayName)
        
        \(Constants.BotMessage.enterProductInfo)
        """
    }
    
    static func customCategoryPrompt() -> String {
        """
        โ๏ธ *ะกะฒะพั ะบะฐัะตะณะพัะธั*
        
        ะะฐะฟะธัะธ ะฝะฐะทะฒะฐะฝะธะต ะบะฐัะตะณะพัะธะธ ัะพะฒะฐัะฐ:
        
        ๐ *ะัะธะผะตัั:*
        โข ะะฝะธะณะธ ะธ ะถััะฝะฐะปั
        โข ะะฒัะพะทะฐะฟัะฐััะธ
        โข ะะพะพัะพะฒะฐัั
        โข ะะตััะบะธะต ะธะณัััะบะธ
        โข ะกะฐะดะพะฒัะน ะธะฝะฒะตะฝัะฐัั
        โข ะกััะพะธัะตะปัะฝัะต ะผะฐัะตัะธะฐะปั
        โข ะัะทัะบะฐะปัะฝัะต ะธะฝััััะผะตะฝัั
        
        ะะปะธ /cancel ะดะปั ะพัะผะตะฝั
        """
    }
    
    static func customCategoryAccepted(_ categoryName: String) -> String {
        """
        โ ะะฐัะตะณะพัะธั: *\(categoryName)*
        
        ะัะปะธัะฝะพ! ะขะตะฟะตัั ะพะฟะธัะธ ัะพะฒะฐั:
        
        ๐ ะะฐะฟัะธะผะตั:
        "\(categoryName) [ะฝะฐะทะฒะฐะฝะธะต ะผะพะดะตะปะธ], ัะฐัะฐะบัะตัะธััะธะบะธ, ะพัะพะฑะตะฝะฝะพััะธ"
        
        ๐ท ะะปะธ ะพัะฟัะฐะฒั ัะพัะพ ัะพะฒะฐัะฐ
        """
    }
    
    static func photoLimitExceeded(plan: Constants.SubscriptionPlan) -> String {
        """
        ๐ท *ะะธะผะธั ัะพัะพ ะธััะตัะฟะฐะฝ!*
        
        ะขะฒะพะน ะฟะปะฐะฝ: *\(plan.emoji) \(plan.name)*
        ะััะฐะปะพัั ัะพัะพ: *0*
        
        ะะฑะฝะพะฒะธ ะฟะฐะบะตั ะดะปั ะฑะพะปััะตะณะพ ะบะพะปะธัะตััะฒะฐ ะพะฟะธัะฐะฝะธะน ะฟะพ ัะพัะพ:
        
        ๐ฆ ะะฐะปัะน (299โฝ): 20 ะพะฟะธัะฐะฝะธะน (3 ัะพัะพ)
        ๐ฆ๐ฆ ะกัะตะดะฝะธะน (599โฝ): 50 ะพะฟะธัะฐะฝะธะน (5 ัะพัะพ)
        ๐ฆ๐ฆ๐ฆ ะะพะปััะพะน (999โฝ): 100 ะพะฟะธัะฐะฝะธะน (10 ัะพัะพ)
        ๐๐ ะะฐะบัะธะผะฐะปัะฝัะน (1,399โฝ): 200 ะพะฟะธัะฐะฝะธะน (20 ัะพัะพ)
        
        /subscribe - ะฟะพัะผะพััะตัั ะฒัะต ะฟะฐะบะตัั
        """
    }
}

